<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daimara Stores | Gas Refilling</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f5f5f5;padding:20px;padding-top: 160px; font-size: 25px; padding-bottom: 100px;}

/* FOOTER */
.footer {
  background: #0a0a0a;
  color: white;
  padding: 30px 20px;
  text-align: center;
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  z-index: 1000;
}
.footer p {
  color: rgb(233, 157, 17);
}

/* NAVBAR */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: #111;
  color: #fff;
  padding: 10px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 1000;
}
.logo { color: #e99d11; font-weight: bold; text-decoration: none; font-size: 18px; }
.nav-links a { color: #fff; text-decoration: none; margin-left: 10px; font-size: 18px; }
@media (max-width: 768px) {
  body { padding-top: 80px; font-size: 16px; padding-bottom: 80px; }
  .navbar { padding: 10px; flex-direction: row; height: 60px; justify-content: space-between; align-items: center; }
  .nav-links a { font-size: 16px; margin-left: 0; }
  .container { margin-top: 30px; padding: 15px; }
  .sizes { grid-template-columns: repeat(3, 1fr); gap: 8px; }
  .card { padding: 5px; }
  .card img { height: 80px; }
  .card h3 { font-size: 11px; margin: 4px 0; }
  .card p { font-size: 10px; margin: 2px 0; }
  .card strong { font-size: 11px; }
  .card button { padding: 5px; font-size: 10px; }
  
  /* BOTTOM NAV */
  .bottom-nav {
    display: flex !important;
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #000;
    height: 60px;
    justify-content: space-around;
    align-items: center;
    z-index: 2000;
    border-top: 2px solid rgb(233, 157, 17);
  }
  .bottom-nav a {
    color: white;
    text-decoration: none;
    font-size: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .bottom-nav a.active { color: rgb(233, 157, 17); }
  .bottom-nav a span { font-size: 10px; margin-top: 4px; }
}

.bottom-nav { display: none; }

@media (max-width: 480px) {
  h2 { font-size: 1.2rem; }
  .sizes { grid-template-columns: repeat(3, 1fr); }
}
 /*.search-container {
  position: fixed;
  top: 65px;
  left: -28px;
  width: 450px;
  margin: 0 0 0 30px;
  z-index: 1001;
}

#search-input {
  width: 100%;
  padding: 10px;
  border: none;
  background-color:#0000009a ;
  border-radius: 5px;
   font-size: 18px;
}

#search-input::placeholder {
  color: #000000;
  opacity: 1;
}

#search-btn {
  position: absolute;
  right: 10px;
  top: 14px;
  background: none;
  border: none;
  cursor: pointer;
}

#search-results {
  position: absolute;
  top: 45px;
  width: 100%;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 5px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  display: none;
  z-index: 1001;
  max-height: 300px;
  overflow-y: auto;
  left: 0;
}

#search-results div {
  padding: 10px;
  border-bottom: 1px solid #eee;
  cursor: pointer;
  color: #333;
  transition: 0.2s;
  background-color: #f9f9f9;
}

#search-results div:hover {
  background: #000000;
  color: #ffffff;
}

#search-results strong {
  color: #1d1c1c;
}*/


.container{max-width:900px;margin:auto;background:#fff;border: none;padding:25px;border-radius:10px;margin-top: 100px;}
h2{text-align:center;color:#e99d11}
.sizes{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}
.card{border:1px solid #6b686898;border-radius:10px;padding:15px;text-align:center}
.card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
.card button{background:#111;color:#e99d11;border:none;padding:8px 15px;border-radius:5px}
label{display:block;margin-top:15px}
#qty{width:100%;padding:10px}
button.order{width:100%;margin-top:20px;padding:12px;background:#111;color:#e99d11;border:none;border-radius:5px}


.shop-icon {
            position: relative;
            width: 40px;
            height: 35px;
            background-color: transparent;
            border: 3px solid rgb(233, 157, 17);
            border-radius: 4px;
            margin: 20px;
        }

        .shop-icon::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 18px;
            height: 12px;
            border: 3px solid rgb(233, 157, 17);
            border-bottom: none;
            border-radius: 10px 10px 0 0;
        }

        .shop-icon::after {
            content: '';
            position: absolute;
            top: 10px;
            left: 8px;
            width: 24px;
            height: 2px;
            background-color: #ffffff;
            box-shadow: 0 6px 0 #a7884f;
        }
</style>
</head>

<body>

<nav class="navbar">
  <div class="nav-links">
    <a href="index.html" style="font-weight:bold;font-size:25px;color:rgb(233, 157, 17);">Daimara-Gas</a>
  </div>
</nav>

<div class="bottom-nav">
  <a href="index.html"><i class="fa fa-home"></i><span>Home</span></a>
  <a href="about.html"><i class="fas fa-info-circle"></i><span>About</span></a>
  <a href="contact.html"><i class="fas fa-phone"></i><span>Contact</span></a>
  <a href="cart.html" style="position:relative;">
    <i class="fa fa-shopping-cart"></i>
    <span class="cart-badge" style="position:absolute; top:-5px; right:15px; background:red; color:white; border-radius:50%; padding:2px 5px; font-size:10px; display:none;">0</span>
    <span>Cart</span>
  </a>
  <a href="profile.html"><i class="fa fa-user"></i><span>Profile</span></a>
</div>

<!--<footer class="footer">
  <p>Copyright Â© 2026 Daimara Online Mart.All rights reserved.</p>
</footer>-->

<!--<div class="search-container">
  <input type="text" id="search-input" placeholder="Search products...">
  <div id="search-results"></div>
</div>-->

<div class="container">
<h2>Gas Refilling</h2>

<div class="sizes" id="gas-products-container">
  <!-- Dynamic content from DataManager -->
</div>

<label>Selected Gas Size</label>
<input id="gasSize" readonly>

<label>Quantity</label>
<input type="number" id="qty" value="1" min="1">

<button class="order" onclick="placeGasOrder()">Add to Cart</button>
</div>

<script src="data-manager.js"></script>
<script src="auth-check.js"></script>
<script>
let selectedGas = null;

// Render Gas Products
function renderGasProducts() {
  const container = document.getElementById('gas-products-container');
  const allProducts = DataManager.getAllProducts();
  const gasProducts = allProducts['Gas'] || [];

  if (gasProducts.length === 0) {
    container.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No gas products available.</p>';
    return;
  }

  container.innerHTML = gasProducts.map(p => `
    <div class="card">
      <img src="${p.image || 'https://picsum.photos/300/200?gas'}">
      <h3>${p.name}</h3>
      <p>${p.description || 'Gas refill service'}</p>
      <p><strong>Price: KSh ${p.price}</strong></p>
      <button onclick="selectGasById('${p.id}')">Select</button>
    </div>
  `).join('');
}

// Select gas
function selectGasById(id){
  const allProducts = DataManager.getAllProducts();
  const gasProducts = allProducts['Gas'] || [];
  const product = gasProducts.find(p => p.id === id);
  if(!product) return;

  document.getElementById("gasSize").value = product.name;
  selectedGas = { ...product };
  
  // Ensure product is in warehouse for admin to see
  DataManager.addToWarehouse(selectedGas, 1);
}

// Select gas (legacy support)
function selectGas(size, price, image){
  document.getElementById("gasSize").value = size;
  selectedGas = {
    id: "gas-" + size.replace(/\s+/g, '-').toLowerCase(),
    name: "Gas Refill (" + size + ")",
    size,
    price,
    image,
    subcategory: 'Gas'
  };
  
  // Ensure product is in warehouse for admin to see
  DataManager.addToWarehouse(selectedGas, 1);
}

// Initialize
renderGasProducts();

// Place order
function placeGasOrder(){
  if(!selectedGas){
    alert("Please select gas size");
    return;
  }

  const quantity = parseInt(document.getElementById("qty").value) || 1;
  
  // Use DataManager
  for(let i=0; i<quantity; i++) {
    DataManager.addToCart({
      ...selectedGas
    });
  }

  alert("Added to cart!");
  window.location.href = "cart.html";
}

// Search functionality
(function() {
  const searchInput = document.getElementById('search-input');
  const searchResults = document.getElementById('search-results');

  function getAllFlattened(){
    const all = DataManager.getAllProducts();
    return Object.keys(all).reduce((acc,k)=> acc.concat(all[k]||[]), []);
  }

  searchInput.addEventListener('input', () => {
    const query = searchInput.value.trim().toLowerCase();
    if (!query) {
      searchResults.style.display = 'none';
      return;
    }

    const all = getAllFlattened();
    const results = all.filter(p => p.name.toLowerCase().includes(query));

    if (results.length > 0) {
      searchResults.innerHTML = results.map(p => {
        let url = 'store.html?search=' + encodeURIComponent(p.name);
        if (p.subcategory === 'Gas') url = 'gas-refill.html';
        if (p.subcategory === 'Water') url = 'water refil.html';
        
        return `
          <div onclick="window.location.href='${url}'">
            <strong>${p.name}</strong><br>
            <span style="font-size: 12px; color: #666;">Ksh ${p.price}</span>
          </div>
        `;
      }).join('');
      searchResults.style.display = 'block';
    } else {
      searchResults.innerHTML = '<div style="padding: 10px;">No results</div>';
      searchResults.style.display = 'block';
    }
  });

  document.addEventListener('click', (e) => {
    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
      searchResults.style.display = 'none';
    }
  });
})();
</script>

</body>
</html>
