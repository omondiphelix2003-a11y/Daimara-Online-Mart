<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Daimara Online Mart | Home</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    :root{
      --primary:#e99d11;
      --dark:#111;
      --bg:#f5f5f5;
      --card:#ffffff;
      --text:#1f2937;
      --border:#e5e7eb;
      --shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
    }

    body{
      background:var(--bg);
      color:var(--text);
      font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height:1.6;
      padding-bottom:80px;
      min-height:100vh;
    }

    /* ADVERTISEMENT BAR */
    .ad-bar{
      background:var(--primary);
      color:var(--dark);
      text-align:center;
      padding:0.5rem 1rem;
      font-size:clamp(0.875rem, 2vw, 1rem);
      font-weight:600;
      position:sticky;
      top:0;
      z-index:1001;
    }

    /* NAVBAR */
    .navbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:clamp(0.75rem, 2vw, 1rem) clamp(1rem, 3vw, 1.5rem);
      background:black;
      color:#fff;
      position:sticky;
      top:0;
      z-index:1000;
      box-shadow:var(--shadow);
      flex-wrap:wrap;
      gap:1rem;
      border-radius:1px;
      border:1px solid black;
    }

    .logo{
      color:var(--primary);
      font-size:clamp(1.25rem, 3vw, 1.75rem);
      font-weight:bold;
      text-decoration:none;
      display:flex;
      align-items:center;
      gap:0.5rem;
      transition:transform 0.2s;
    }

    .logo:hover{
      transform:scale(1.05);
      cursor: pointer;
    }

    .nav-center{
      display:flex;
      align-items:center;
      gap:clamp(1rem, 3vw, 1.5rem);
      flex:1;
      justify-content:center;
    }

    .nav-center a{
      color:rgb(233,157,17);
      text-decoration:none;
      font-size:clamp(1.25rem, 3vw, 1.5rem);
      transition:color 0.2s;
      width:44px;
      height:44px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:50%;
    }

    .nav-center a:hover,
    .nav-center a.active{
      color:var(--primary);
      background:rgba(255,255,255,0.1);
    }

    .nav-icons{
      display:flex;
      align-items:center;
      gap:clamp(0.5rem, 2vw, 1rem);
    }

    .nav-icons a{
      color:#fff;
      font-size:clamp(1.25rem, 3vw, 1.5rem);
      text-decoration:none;
      transition:color 0.2s;
      width:44px;
      height:44px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:50%;
      position:relative;
      overflow:visible;
    }

    .nav-icons a:hover{
      color:var(--primary);
      background:rgba(255,255,255,0.1);
    }

    .cart-count{
      position:absolute;
      top:-12px;
      right:-12px;
      background:#000;
      color:#fff;
      font-size:12px;
      font-weight:bold;
      width:22px;
      height:22px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      line-height:1;
      padding:0;
      margin:0;
      z-index:10;
    }

    /* Shop Icon */
    .shop-icon{
      position:relative;
      width:32px;
      height:28px;
      background:transparent;
      border:2px solid var(--primary);
      border-radius:3px;
    }

    .shop-icon::before{
      content:'';
      position:absolute;
      top:-10px;
      left:50%;
      transform:translateX(-50%);
      width:14px;
      height:10px;
      border:2px solid var(--primary);
      border-bottom:none;
      border-radius:8px 8px 0 0;
    }

    .shop-icon::after{
      content:'';
      position:absolute;
      top:8px;
      left:6px;
      width:18px;
      height:2px;
      background:var(--primary);
      box-shadow:0 4px 0 var(--primary);
    }

    /* SEARCH CONTAINER */
    .search-container{
      position:relative;
      width:100%;
      max-width:600px;
      margin:1rem auto;
      padding:0 1rem;
    }

    #search-input{
      width:100%;
      padding:0.875rem 1rem;
      border:2px 2px solid #0000003d;
      border-radius:50px;
      background:#e9e9e9;
      font-size:1rem;
      transition:all 0.2s;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    #search-input:focus{
      outline:none;
      border-color:var(--primary);
      box-shadow:0 0 0 3px rgba(233, 157, 17, 0.1);
    }

    #search-results{
      position:absolute;
      top:calc(100% + 8px);
      left:1rem;
      right:1rem;
      background:white;
      border:1px solid var(--border);
      border-radius:12px;
      box-shadow:0 10px 25px rgba(0,0,0,0.1);
      display:none;
      z-index:100;
      max-height:300px;
      overflow-y:auto;
    }

    #search-results div{
      padding:0.875rem 1rem;
      border-bottom:1px solid var(--border);
      cursor:pointer;
      transition:all 0.2s;
      display:flex;
      flex-direction:column;
      gap:0.25rem;
    }

    #search-results div:hover{
      background:var(--primary);
      color:white;
    }

    #search-results div:hover strong{
      color:white;
    }

    #search-results strong{
      color:var(--text);
      font-size:1rem;
    }

    #search-results span{
      font-size:0.875rem;
      color:#6b7280;
    }

    #search-results div:hover span{
      color:rgba(255,255,255,0.9);
    }

    /* SLIDER */
    .slider{
      position:relative;
      width:100%;
      height:clamp(250px, 50vw, 500px);
      overflow:hidden;
      margin-top:1rem;
      border-radius:0 0 24px 24px;
    }

    .slide{
      display:none;
      width:100%;
      height:100%;
    }

    .slide.active{
      display:block;
    }

    .slide img{
      width:100%;
      height:100%;
      object-fit:cover;
    }

    .slider-nav{
      position:absolute;
      bottom:1rem;
      left:50%;
      transform:translateX(-50%);
      display:flex;
      gap:0.5rem;
      z-index:10;
    }

    .slider-dot{
      width:12px;
      height:12px;
      border-radius:50%;
      background:rgba(255,255,255,0.5);
      cursor:pointer;
      transition:all 0.2s;
      border:2px solid transparent;
    }

    .slider-dot.active{
      background:var(--primary);
      transform:scale(1.2);
    }

    /* SECTIONS */
    section{
      padding:clamp(2rem, 5vw, 4rem) clamp(1rem, 3vw, 2rem);
      max-width:1400px;
      margin:0 auto;
    }

    h2{
      color:var(--text);
      text-align:center;
      margin-bottom:1.5rem;
      font-size:clamp(1.5rem, 4vw, 2.25rem);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:0.75rem;
    }

    /* DELIVERY CARDS */
    .delivery{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(min(100%, 300px), 1fr));
      gap:clamp(1rem, 3vw, 1.5rem);
    }

    .delivery-card{
      background:var(--card);
      padding:clamp(1.5rem, 4vw, 2rem);
      border-radius:16px;
      box-shadow:var(--shadow);
      text-align:center;
      transition:all 0.3s;
      border:1px solid var(--border);
      display:flex;
      flex-direction:column;
      gap:1rem;
    }

    .delivery-card:hover{
      transform:translateY(-4px);
      box-shadow:0 20px 25px -5px rgba(0,0,0,0.1);
      border-color:var(--primary);
    }

    .delivery-card i{
      font-size:clamp(2.5rem, 6vw, 3rem);
      color:var(--primary);
    }

    .delivery-card h3{
      font-size:clamp(1.25rem, 3vw, 1.5rem);
      color:var(--text);
    }

    .delivery-card img{
      width:100%;
      height:200px;
      object-fit:cover;
      border-radius:12px;
    }

    .delivery-card p{
      color:#6b7280;
      flex:1;
    }

    .delivery-card button{
      padding:0.875rem 1.5rem;
      border:none;
      border-radius:10px;
      background:var(--dark);
      color:var(--primary);
      font-weight:600;
      cursor:pointer;
      transition:all 0.2s;
      font-size:1rem;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:0.5rem;
      margin-top:auto;
    }

    /*.delivery-card button:hover{
      background:var(--primary);
      color:var(--dark);
      transform:translateY(-2px);
    }*/

    /* VIDEO SECTION */
    .video-box{
      display:flex;
      justify-content:center;
      padding:0 1rem;
    }

    video{
      width:100%;
      max-width:900px;
      border-radius:16px;
      box-shadow:var(--shadow);
    }

    /* PRODUCTS GRID */
    .products{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(min(100%, 250px), 1fr));
      gap:clamp(1rem, 3vw, 1.5rem);
      padding:0;
      
       /*width:280%;
      height:100px;*/
    }
    
    @media (max-width: 1024px) {
      .products {
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }
    }

    .product{
      background:var(--card);
      padding:clamp(1rem, 3vw, 1.25rem);
      border-radius:16px;
      box-shadow:var(--shadow);
      text-align:center;
      transition:all 0.3s;
      border:1px solid var(--border);
      display:flex;
      flex-direction:column;
      gap:0.75rem;
    }

    .product:hover{
      transform:translateY(-4px);
      box-shadow:0 20px 25px -5px rgba(0,0,0,0.1);
      border-color:var(--primary);
    }

    .product img{
      width:100%;
      height:150px;
      object-fit:cover;
      border-radius:12px;
      background:#f3f4f6;
    }

    .product h4{
      font-size:1.125rem;
      color:var(--text);
      margin:0;
    }

    .product p{
      color:var(--primary);
      font-size:1.25rem;
      font-weight:700;
      margin:0;
    }

    .product button{
      padding:0.75rem 1rem;
      border:none;
      border-radius:8px;
      background:var(--dark);
      color:var(--primary);
      font-weight:600;
      cursor:pointer;
      transition:all 0.2s;
      margin-top:auto;
    }

    .product button:hover{
      background:var(--primary);
      color:var(--dark);
    }

    /* FOOTER */
    .footer{
      background:var(--dark);
      color:white;
      padding:1.5rem 1rem;
      text-align:center;
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      z-index:100;
      font-size:0.875rem;
    }

    .footer p{
      color:var(--primary);
      margin:0;
    }

    /* LOADING STATE */
    .loading-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(250px, 1fr));
      gap:1.5rem;
    }

    .skeleton{
      background:linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size:200% 100%;
      animation:loading 1.5s infinite;
      border-radius:16px;
      height:300px;
    }

    @keyframes loading{
      0%{background-position:200% 0;}
      100%{background-position:-200% 0;}
    }

    /* TOAST NOTIFICATION */
    .toast{
      position:fixed;
      bottom:100px;
      left:50%;
      transform:translateX(-50%) translateY(100px);
      background:var(--dark);
      color:white;
      padding:1rem 1.5rem;
      border-radius:12px;
      box-shadow:0 10px 25px rgba(0,0,0,0.2);
      display:flex;
      align-items:center;
      gap:0.75rem;
      opacity:0;
      transition:all 0.3s;
      z-index:2000;
      font-weight:500;
    }

    .toast.show{
      transform:translateX(-50%) translateY(0);
      opacity:1;
    }

    /* RESPONSIVE BREAKPOINTS */
    @media (max-width:640px){
      .navbar{
        padding:0.75rem;
      }

      .nav-center{
        order:3;
        width:100%;
        justify-content:center;
        gap:1.5rem;
        border-top:1px solid #fff;
        padding-top:1rem;
      }

      .slider{
        border-radius:0 0 16px 16px;
        height:200px;
      }

      .delivery-card img{
        height:150px;
      }

      .product img{
        height:140px;
      }
    }

    @media (min-width:641px) and (max-width:1024px){
      .products{
        grid-template-columns:repeat(3, 1fr);
      }
    }

    @media (min-width:1025px){
      .products{
        grid-template-columns:repeat(4, 1fr);
      }
    }

    /* TOUCH OPTIMIZATIONS */
    @media (hover:none) and (pointer:coarse){
      .delivery-card,
      .product{
        transform:none !important;
      }

      .nav-center a,
      .nav-icons a{
        min-width:44px;
        min-height:44px;
      }
    }

    /* DARK MODE */
    @media (prefers-color-scheme:dark){
      :root{
        --bg:#1F2937;
        --card:#1F2937;
        --text:#f9fafb;
        --border:#374151;
      }

      .skeleton{
        background:linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
      }
    }

    /* REDUCED MOTION */
    @media (prefers-reduced-motion:reduce){
      *{
        animation-duration:0.01ms !important;
        animation-iteration-count:1 !important;
        transition-duration:0.01ms !important;
      }
    }
  </style>
</head>
<body>

  <!-- ADVERTISEMENT BAR -->
  <div class="ad-bar">
    <i class="fas fa-bullhorn"></i> Advertise with us! Contact sales@daimara.com
  </div>

  <!-- NAVBAR -->
  <nav class="navbar">
      <i class="fas fa-store"style="font-size:27px;color:rgb(233,157,17);"></i><div class="logo"style="font-size:23px;color:white;">Daimara</div> 
    </a>

    <div class="nav-center">
      <a href="store.html" title="Shop">
        <div class="shop-icon"></div>
      </a>
      <a href="about.html" title="About">
        <i class="fas fa-info-circle"></i>
      </a>
      <a href="contact.html" title="Contact">
        <i class="fas fa-phone"></i>
      </a>
    </div>

    <div class="nav-icons">
      <a href="login.html" title="Account">
        <i class="fas fa-user"></i>
      </a>
      <a href="cart.html" class="cart-link" title="Cart">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" id="cartCount">0</span>
      </a>
    </div>
  </nav>

  <!-- SEARCH -->
  <div class="search-container">
    <input type="text" id="search-input" placeholder="Search for products...">
    <div id="search-results"></div>
  </div>

  <!-- SLIDESHOW -->
  <div class="slider">
    <div class="slide active">
      <img src="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=1200&h=500&fit=crop" alt="Shopping">
    </div>
    <div class="slide">
      <img src="https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=1200&h=500&fit=crop" alt="Delivery">
    </div>
    <div class="slide">
      <img src="https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=1200&h=500&fit=crop" alt="Gas">
    </div>
    <div class="slider-nav">
      <div class="slider-dot active" onclick="goToSlide(0)"></div>
      <div class="slider-dot" onclick="goToSlide(1)"></div>
      <div class="slider-dot" onclick="goToSlide(2)"></div>
    </div>
  </div>

  <!-- DELIVERY OPTIONS -->
  <section>
    <h2><i class="fas fa-shipping-fast"></i> Fast Home Delivery</h2>
    <div class="delivery">
      <div class="delivery-card">
        <i class="fas fa-tint"></i>
        <h3>Water Refilling</h3>
        <img src="https://images.unsplash.com/photo-1548839140-29a749e1cf4d?w=400&h=300&fit=crop" alt="Water">
        <p>Clean and safe water delivered to your doorstep. Choose from various bottle sizes.</p>
        <a href="water refilling.html">
          <button><i class="fas fa-shopping-cart"style="font-size:22px"></i> Order Now</button>
        </a>
      </div>

      <div class="delivery-card">
        <i class="fas fa-fire"></i>
        <h3>Gas Refilling</h3>
        <img src="https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=400&h=300&fit=crop" alt="Gas">
        <p>Quick and reliable gas refilling service. All cylinder sizes available.</p>
        <a href="gas-refill.html">
          <button><i class="fas fa-shopping-cart"style="font-size:22px"></i> Order Now</button>
        </a>
      </div>

      <div class="delivery-card">
        <i class="fas fa-box"></i>
        <h3>Grocery Pick</h3>
        <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=300&fit=crop" alt="Groceries">
        <p>Fresh groceries delivered from your favorite local stores.</p>
        <a href="grocery delivery.html">
          <button><i class="fas fa-shopping-cart"style="font-size:22px"></i> Shop Now</button>
        </a>
      </div>
    </div>
  </section>

  <!-- VIDEO AD -->
  <section>
    <h2><i class="fas fa-play-circle"></i> Featured Promotion</h2>
    <div class="video-box">
      <video controls autoplay muted loop poster="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=900&h=500&fit=crop">
        <source src="video2.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
  </section>

  <!-- RANDOM PRODUCTS -->
  <section>
    <h2><i class="fas fa-fire"></i> Trending Products</h2>
    <div class="products" id="random-products">
      <div class="loading-grid">
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <p>Â© 2026 Daimara Online Mart. All rights reserved.</p>
  </footer>

  <!-- TOAST -->
  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span>Added to cart!</span>
  </div>

  <script src="data-manager.js"></script>
  <script src="auth-check.js"></script>
  <script src="navigation-helper.js"></script>
  <script>
    // SLIDER
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.slider-dot');

    function showSlide(index){
      slides.forEach((slide, i) => {
        slide.classList.toggle('active', i === index);
        dots[i].classList.toggle('active', i === index);
      });
    }

    function nextSlide(){
      currentSlide = (currentSlide + 1) % slides.length;
      showSlide(currentSlide);
    }

    function goToSlide(index){
      currentSlide = index;
      showSlide(currentSlide);
    }

    // Auto-advance slider
    setInterval(nextSlide, 5000);

    // RANDOM PRODUCTS
    (function(){
      const rndContainer = document.getElementById('random-products');

      function getAllFlattened(){
        if(typeof DataManager === 'undefined') return [];
        const all = DataManager.getAllProducts();
        return Object.keys(all).reduce((acc,k) => acc.concat(all[k] || []), []);
      }

      window.addToCartById = function(id){
        if(typeof DataManager === 'undefined'){
          showToast('Error: DataManager not loaded', 'error');
          return;
        }
        const prod = getAllFlattened().find(p => p.id === id);
        if(!prod){
          showToast('Product not found', 'error');
          return;
        }
        DataManager.addToCart(prod);
        updateCartCount();
        showToast('Added to cart!');
      };

      function renderRandom(n = 8){
        if(!rndContainer) return;
        const all = getAllFlattened();

        if(all.length === 0){
          rndContainer.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #6b7280;">No products available yet.</p>';
          return;
        }

        const shuffled = all.slice().sort(() => 0.5 - Math.random()).slice(0, n);
        rndContainer.innerHTML = '';

        shuffled.forEach(p => {
          const img = p.image || `https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=300&h=200&fit=crop`;
          rndContainer.innerHTML += `
            <div class="product">
              <img src="${img}" alt="${p.name}" loading="lazy">
              <h4>${p.name}</h4>
              <p>Ksh ${parseInt(p.price).toLocaleString()}</p>
              <button onclick="addToCartById('${p.id}')">
                <i class="fas fa-cart-plus"></i> Add to Cart
              </button>
            </div>
          `;
        });
      }

      // Initial render
      setTimeout(renderRandom, 500);

      // Real-time synchronization
      window.addEventListener('storage', (e) => {
        if(e.key === 'daimara_products' || e.key === 'ecommerce_products'){
          renderRandom(8);
        }
      });
    })();

    // SEARCH FUNCTIONALITY
    const searchInput = document.getElementById('search-input');
    const searchResults = document.getElementById('search-results');

    function performSearch(){
      const query = searchInput.value.trim().toLowerCase();
      if(!query){
        searchResults.style.display = 'none';
        return;
      }

      if(typeof DataManager === 'undefined'){
        searchResults.innerHTML = '<div style="padding: 10px;">Loading...</div>';
        searchResults.style.display = 'block';
        return;
      }

      const allProducts = [];
      const products = DataManager.getAllProducts();
      Object.values(products).forEach(categoryList => {
        allProducts.push(...categoryList);
      });

      const results = allProducts.filter(p =>
        p.name.toLowerCase().includes(query) ||
        (p.description && p.description.toLowerCase().includes(query))
      );

      if(results.length > 0){
        searchResults.innerHTML = results.slice(0, 5).map(p => {
          let url = 'store.html?search=' + encodeURIComponent(p.name);
          if(p.subcategory === 'Gas') url = 'gas-refill.html';
          if(p.subcategory === 'Water') url = 'water-refill.html';

          return `
            <div onclick="window.location.href='${url}'">
              <strong>${p.name}</strong>
              <span>Ksh ${parseInt(p.price).toLocaleString()}</span>
            </div>
          `;
        }).join('');
        searchResults.style.display = 'block';
      } else {
        searchResults.innerHTML = '<div style="padding: 10px;">No products found</div>';
        searchResults.style.display = 'block';
      }
    }

    searchInput.addEventListener('input', performSearch);

    // Close search results when clicking outside
    document.addEventListener('click', (e) => {
      if(!searchInput.contains(e.target) && !searchResults.contains(e.target)){
        searchResults.style.display = 'none';
      }
    });

    // CART COUNT
    function updateCartCount(){
      if(typeof DataManager === 'undefined') return;
      const cart = DataManager.getCart() || [];
      const count = cart.length;
      const badge = document.getElementById('cartCount');
      if(badge){
        badge.textContent = count;
        badge.style.display = count > 0 ? 'flex' : 'none';
      }
    }

    // TOAST NOTIFICATION
    function showToast(message, type = 'success'){
      const toast = document.getElementById('toast');
      const icon = toast.querySelector('i');
      const text = toast.querySelector('span');

      toast.className = 'toast ' + (type === 'error' ? 'error' : '');
      text.textContent = message;
      icon.className = type === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';

      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateCartCount();
    });
  </script>
</body>
</html>